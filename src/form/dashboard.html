<!DOCTYPE html>
<html lang="en">
    <style>
        html, body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(to right, #36d1dc, #5b86e5);
            margin: 0;
            padding-top: 50px;
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        body::-webkit-scrollbar {
        display: none;
        }
        i.fas {
            width: 20px; 
            height: 20px; 
            justify-content: center;
            align-items: center;
            display: flex;
        }
        .select-form-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 20px;
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
        }

        .select-form-group label {
            margin-bottom: 10px;
            font-size: 18px;
            color: #ffffff;
            font-weight: bold;
        }

        .select-form-group select {
            padding: 15px;
            font-size: 18px;
            border-radius: 10px;
            border: none;
            box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.1);
            background-color: #ffffff;
            color: #000000;
        }
        #submit-add-exercise:hover {
        background-color: #5b86e5; /* Change color on hover */
        transition: background-color 0.3s ease; /* Smooth transition */
        }
        #error-message {
        color: #721c24;
        background-color: #f8d7da;
        border-color: #f5c6cb;
        padding: .75rem 1.25rem;
        margin-bottom: 1rem;
        border: 1px solid transparent;
        border-radius: .25rem;
        position: fixed; /* Position it at a fixed spot on the screen */
        top: 20px; /* 20px from the top */
        left: 50%; /* Center it horizontally */
        transform: translateX(-50%); /* Center it horizontally */
        opacity: 0; /* Start invisible */
        transition: opacity 0.5s ease; /* Animate the opacity */
        font-family: 'Roboto', sans-serif; /* Use the same font as the rest of the page */
        text-align: center; /* Center the text */
        width: 80%; /* Take up 80% of the screen width */
        max-width: 600px; /* But don't be wider than 600px */
        z-index: 1000; /* Make sure it's on top of other elements */
    }
    </style>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/4b0f9d2f56.js" crossorigin="anonymous"></script>
</head>
<body>
    <div style="padding-bottom: 30px; display: flex; justify-content: center;">
        <img src="/images/logo-monochrome-jpg-thumb.png" alt="Athletex logo" style="height: 120px; border: 1px solid #ffffff; border-radius: 50px; box-shadow: 2px 2px 3px rgba(0, 0, 5, 0.4);">
    </div>    <button id="logout-button" style="position: absolute; top: 20px; right: 20px; font-weight: bold; padding: 10px 20px; color: #fffffff0; cursor: pointer; font-size: 16px; display: flex; align-items: center;">
        <i class="fas fa-sign-out-alt" style="margin-right: 5px;"></i><span>Logout</span>
    </button>
    <div id="error-message" style="display: block;"></div>
    <div class="container-fluid">
        <h2 class="text-center mb-5" style="color: white; font-size: 24px; font-weight: bold; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center;">
            <i class="fas fa-basketball" style="margin-right: 15px; color: white;"></i> Add Exercise
        </h2>
        <form id="add-exercise-form">
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-basketball"></i></span>
                            </div>
                            <input class="form-control" name="exerciseName" id="exerciseName" type="text" placeholder="Exercise name">
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-info"></i></span>
                            </div>
                            <textarea class="form-control" name="description" placeholder="Description" id="description" rows="4" style="text-align: cen"></textarea>                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-fire"></i></span>
                            </div>
                            <input class="form-control" name="effortLevel" id="effortLevel" min="1" max="10" type="number" placeholder="Effort Level (1-10)">
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-clock"></i></span>
                            </div>
                            <input class="form-control" id="duration" name="duration" type="number" min="1" max="20" placeholder="Duration (1-20) Minutes">
                            <div class="input-group-append">
                                <span class="input-group-text">Minutes</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-box"></i></span>
                            </div>
                            <select class="form-control" name="equipment" id="equipment" multiple style="height: 200px;">
                                <option value="COURT" disabled="true" selected>Equipment</option>

                                <option value="BASKETBALL">Basketball</option>
                                <option value="CONES">Cones</option>
                                <option value="HOOP">Hoop</option>
                                <option value="JUMP_ROPE">Jump Rope</option>
                                <option value="MEDICINE_BALL">Medicine Ball</option>
                                <option value="RESISTANCE_BAND">Resistance Band</option>
                                <option value="WEIGHTS">Weights</option>
                                <option value="NONE">None</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-video"></i></span>
                            </div>
                            <div class="custom-file">
                                <input type="file" class="custom-file-input" name="videoFile" id="videoFile" accept="video/*">
                                <label class="custom-file-label" name="video" for="video">Upload video</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group" id="videoCard" style="display: none;">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="card">
                            <div class="card-header">
                                Video Preview
                            </div>
                            <div class="card-body">
                                <video id="videoPreview" controls style="width: 100%; max-height: 300px; display: none; border-radius: 5px; object-fit: cover;"></video>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-street-view"></i></span>
                            </div>
                            <select class="form-control" name="courtArea" id="courtArea">
                                <option value="COURT" disabled="true" selected>Court Area</option>
                                <option value="PAINT">Paint</option>
                                <option value="PERIMETER">Perimeter</option>
                                <option value="HALF_COURT_LINE">Half Court Line</option>
                                <option value="FREE_THROW_LINE">Free throw line</option>
                                <option value="KEY_EXTENDED">Key Extended</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-star"></i></span>
                            </div>
                            <select class="form-control" name="skillLevel" id="skillLevel">
                                <option value="COURT" disabled="true" selected>Skill Level</option>
                                <option value="BEGINNER">Beginner</option>
                                <option value="INTERMEDIATE">Intermediate</option>
                                <option value="ADVANCED">Advanced</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-arrows-to-dot"></i></span>
                            </div>
                            <select class="form-control" name="position" id="position">
                                <option value="COURT" disabled="true" selected>Focus Position</option>

                                <option value="GUARD">Guard</option>
                                <option value="FORWARD">Forward</option>
                                <option value="CENTER">Center</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>  
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-layer-group"></i></span>
                            </div>
                            <select class="form-control" name="exerciseCategory" id="exerciseCategory">
                                <option value="NONE" disabled="true" selected>Exercise Category</option>
                                <option value="SHOOTING">Shooting</option>
                                <option value="DRIBBLING">Dribbling</option>
                                <option value="PASSING">Passing</option>
                                <option value="DEFENDING">Defending</option>
                                <option value="BLOCKING">Blocking</option>
                                <option value="STEALING">Stealing</option>
                                <option value="TWO_POINT_SHOOTING">Two point shooting</option>
                                <option value="THREE_POINT_SHOOTING">Three point shooting</option>
                                <option value="FREE_THROW">Free Throw</option>
                                <option value="REBOUNDING">Rebounding</option>
                                <option value="CONDITIONING">Conditioning</option>
                                <option value="FOOTWORK">Footwork</option>
                                <option value="NONE">None</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-bars"></i></span>
                            </div>
                            <input class="form-control" name="sets"  id="sets" type="number" min="1" max="10" placeholder="Sets">
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-repeat"></i></span>
                            </div>
                            <input class="form-control" name="reps" id="reps" type="number" min="1" max="100" placeholder="Repetitions / Set">
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <div class="row">
                    <div class="col-lg-6 mx-auto">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-sm fa-stopwatch"></i></span>
                            </div>
                            <input class="form-control" name="restPeriod" id="restPeriod" min="1" max="10" type="number" placeholder="Rest Period (1-10) Minutes">
                            <div class="input-group-append">
                                <span class="input-group-text">Minutes</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group text-center" style="display: flex; justify-content: center; padding-top: 20px; padding-bottom: 20px;">
                <button id="submit-add-exercise" style="font-weight: bold; padding: 20px 50px; color: #ffffff; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; display: flex; align-items: center; background-color: black;" onmouseover="this.style.backgroundColor='#5b86e5';" onmouseout="this.style.backgroundColor='black';">
                    <i class="fas fa-plus-circle" style="margin-right: 5px;"></i>Insert Exercise
                </button>
            </div>
        </form>
    </div>
</body>

<script>
document.querySelector('form').addEventListener('submit', function(event) {
    event.preventDefault();
});

document.getElementById('videoFile').addEventListener('change', function() {
    var file = this.files[0];
    var url = URL.createObjectURL(file);
    var video = document.getElementById('videoPreview');

    // check if file is a video and if it isnt then display an error message
    if (file.type.indexOf('video') === -1) {
        alert('Please select a video file');
        return;
    }

    var videoCard = document.getElementById('videoCard');
    video.src = url;
    video.style.display = 'block';
    videoCard.style.display = 'block';

    // change the label of the input field to the name of the video file
    var label = document.querySelector("label[for='videoUrl']");
    label.textContent = file.name;

});

function handleInputChange(event) {
    var input = event.target;
    var min = input.min !== '' ? Number(input.min) : null;
    var max = input.max !== '' ? Number(input.max) : null;
    if (min !== null && input.value < min) {
        input.value = min;
    } else if (max !== null && input.value > max) {
        input.value = max;
    }
}
['duration', 'effortLevel', 'sets', 'reps', 'restPeriod'].forEach(function(id) {
    document.getElementById(id).addEventListener('input', handleInputChange);
});

function submitForm() {
        var form = document.getElementById('add-exercise-form'); 
        var errorMessageDiv = document.getElementById('error-message');

        // send image tag from thumbnail of the video
        var video = document.getElementById('videoPreview');
        var formData = new FormData(form);

        fetch(`/api/v1/exercise?token=${localStorage.getItem("accessToken")}`, {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(response => {
            console.log(response)
            if(response.status === "success") {
                alert('Exercise added successfully');
            } else {
                errorMessageDiv.textContent = response.message ?? 'Exercise could not be added';
                errorMessageDiv.style.opacity = '1'; // Make it visible
            }
            setTimeout(function() {
                errorMessageDiv.style.opacity = '0'; // Make it invisible
            }, 3000);
        })
        .catch(error => console.error('Error:', error));
    }

        var submitButton = document.getElementById('submit-add-exercise'); 
        submitButton.addEventListener('click', function(event) {
            event.preventDefault();
            submitForm();
});

document.getElementById('logout-button').addEventListener('click', function() {
    localStorage.removeItem('accessToken');
    window.location.href = '/api/v1/auth/login';
});

</script>
</html>